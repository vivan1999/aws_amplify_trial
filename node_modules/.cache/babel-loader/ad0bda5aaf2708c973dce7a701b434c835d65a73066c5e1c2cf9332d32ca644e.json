{"ast":null,"code":"import { getElement } from '@stencil/core/internal/client';\n\n/*\n * SPDX-FileCopyrightText: 2023 Siemens AG\n *\n * SPDX-License-Identifier: MIT\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\nconst defaultOptions = {\n  target: 'window',\n  defaultEnabled: true\n};\nfunction createListener(event, options = {}) {\n  const opts = Object.assign(Object.assign({}, defaultOptions), options);\n  let callback;\n  const onEvent = event => {\n    callback(event);\n  };\n  const resultObject = {\n    on: onEventCallback => {\n      callback = onEventCallback;\n    },\n    isEnabled: opts.defaultEnabled,\n    enable: state => {\n      resultObject.isEnabled = state;\n      if (state) {\n        addEventListener(event, onEvent);\n      } else {\n        removeEventListener(event, onEvent);\n      }\n    },\n    destroy: () => {\n      resultObject.enable(false);\n    }\n  };\n  resultObject.enable(opts.defaultEnabled);\n  return resultObject;\n}\nfunction OnListener(event, fnExp) {\n  return (proto, methodName) => {\n    const {\n      componentWillLoad,\n      componentWillRender,\n      disconnectedCallback\n    } = proto;\n    proto.componentWillRender = function () {\n      const host = getElement(this);\n      host[`__ix__${methodName}`].enable(fnExp(this));\n      return componentWillRender && componentWillRender.call(this);\n    };\n    proto.componentWillLoad = function () {\n      const listener = createListener(event);\n      const host = getElement(this);\n      const method = this[methodName];\n      host[`__ix__${methodName}`] = listener;\n      listener.on(method.bind(this));\n      return componentWillLoad && componentWillLoad.call(this);\n    };\n    proto.disconnectedCallback = function () {\n      const host = getElement(this);\n      host[`__ix__${methodName}`].destroy();\n      host[`__ix__${methodName}`] = null;\n      return disconnectedCallback && disconnectedCallback.call(this);\n    };\n  };\n}\nexport { OnListener as O };","map":{"version":3,"names":["defaultOptions","target","defaultEnabled","createListener","event","options","opts","Object","assign","callback","onEvent","resultObject","on","onEventCallback","isEnabled","enable","state","addEventListener","removeEventListener","destroy","OnListener","fnExp","proto","methodName","componentWillLoad","componentWillRender","disconnectedCallback","host","getElement","call","listener","method","bind"],"sources":["D:\\pci_project_new\\node_modules\\@siemens\\ix\\components\\src\\components\\utils\\listener.ts"],"sourcesContent":["/*\n * SPDX-FileCopyrightText: 2023 Siemens AG\n *\n * SPDX-License-Identifier: MIT\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { getElement } from '@stencil/core';\n\nexport type ListenerOptions = {\n  target?: 'window';\n  defaultEnabled?: boolean;\n};\n\nconst defaultOptions: ListenerOptions = {\n  target: 'window',\n  defaultEnabled: true,\n};\n\nexport function createListener(event: string, options: ListenerOptions = {}) {\n  const opts = {\n    ...defaultOptions,\n    ...options,\n  };\n\n  let callback: any;\n  const onEvent = (event: Event) => {\n    callback(event);\n  };\n\n  const resultObject = {\n    on: (onEventCallback: any) => {\n      callback = onEventCallback;\n    },\n\n    isEnabled: opts.defaultEnabled,\n\n    enable: (state: boolean) => {\n      resultObject.isEnabled = state;\n\n      if (state) {\n        addEventListener(event, onEvent);\n      } else {\n        removeEventListener(event, onEvent);\n      }\n    },\n\n    destroy: () => {\n      resultObject.enable(false);\n    },\n  };\n\n  resultObject.enable(opts.defaultEnabled);\n  return resultObject;\n}\n\nexport function OnListener<T>(event: string, fnExp?: (self: T) => boolean) {\n  return (proto: any, methodName: string) => {\n    const { componentWillLoad, componentWillRender, disconnectedCallback } =\n      proto;\n\n    proto.componentWillRender = function () {\n      const host = getElement(this);\n      host[`__ix__${methodName}`].enable(fnExp(this));\n      return componentWillRender && componentWillRender.call(this);\n    };\n\n    proto.componentWillLoad = function () {\n      const listener = createListener(event);\n      const host = getElement(this);\n      const method = this[methodName];\n\n      host[`__ix__${methodName}`] = listener;\n\n      listener.on(method.bind(this));\n      return componentWillLoad && componentWillLoad.call(this);\n    };\n\n    proto.disconnectedCallback = function () {\n      const host = getElement(this);\n\n      host[`__ix__${methodName}`].destroy();\n      host[`__ix__${methodName}`] = null;\n      return disconnectedCallback && disconnectedCallback.call(this);\n    };\n  };\n}\n"],"mappings":";;AAAA;;;;;;;;AAgBA,MAAMA,cAAc,GAAoB;EACtCC,MAAM,EAAE,QAAQ;EAChBC,cAAc,EAAE;CACjB;SAEeC,cAAcA,CAACC,KAAa,EAAEC,OAAA,GAA2B,EAAE;EACzE,MAAMC,IAAI,GAAAC,MAAA,CAAAC,MAAA,CAAAD,MAAA,CAAAC,MAAA,KACLR,cAAc,GACdK,OAAO,CACX;EAED,IAAII,QAAa;EACjB,MAAMC,OAAO,GAAIN,KAAY;IAC3BK,QAAQ,CAACL,KAAK,CAAC;GAChB;EAED,MAAMO,YAAY,GAAG;IACnBC,EAAE,EAAGC,eAAoB;MACvBJ,QAAQ,GAAGI,eAAe;KAC3B;IAEDC,SAAS,EAAER,IAAI,CAACJ,cAAc;IAE9Ba,MAAM,EAAGC,KAAc;MACrBL,YAAY,CAACG,SAAS,GAAGE,KAAK;MAE9B,IAAIA,KAAK,EAAE;QACTC,gBAAgB,CAACb,KAAK,EAAEM,OAAO,CAAC;OACjC,MAAM;QACLQ,mBAAmB,CAACd,KAAK,EAAEM,OAAO,CAAC;;KAEtC;IAEDS,OAAO,EAAEA,CAAA;MACPR,YAAY,CAACI,MAAM,CAAC,KAAK,CAAC;;GAE7B;EAEDJ,YAAY,CAACI,MAAM,CAACT,IAAI,CAACJ,cAAc,CAAC;EACxC,OAAOS,YAAY;AACrB;SAEgBS,UAAUA,CAAIhB,KAAa,EAAEiB,KAA4B;EACvE,OAAO,CAACC,KAAU,EAAEC,UAAkB;IACpC,MAAM;MAAEC,iBAAiB;MAAEC,mBAAmB;MAAEC;IAAoB,CAAE,GACpEJ,KAAK;IAEPA,KAAK,CAACG,mBAAmB,GAAG;MAC1B,MAAME,IAAI,GAAGC,UAAU,CAAC,IAAI,CAAC;MAC7BD,IAAI,CAAC,SAASJ,UAAU,EAAE,CAAC,CAACR,MAAM,CAACM,KAAK,CAAC,IAAI,CAAC,CAAC;MAC/C,OAAOI,mBAAmB,IAAIA,mBAAmB,CAACI,IAAI,CAAC,IAAI,CAAC;KAC7D;IAEDP,KAAK,CAACE,iBAAiB,GAAG;MACxB,MAAMM,QAAQ,GAAG3B,cAAc,CAACC,KAAK,CAAC;MACtC,MAAMuB,IAAI,GAAGC,UAAU,CAAC,IAAI,CAAC;MAC7B,MAAMG,MAAM,GAAG,IAAI,CAACR,UAAU,CAAC;MAE/BI,IAAI,CAAC,SAASJ,UAAU,EAAE,CAAC,GAAGO,QAAQ;MAEtCA,QAAQ,CAAClB,EAAE,CAACmB,MAAM,CAACC,IAAI,CAAC,IAAI,CAAC,CAAC;MAC9B,OAAOR,iBAAiB,IAAIA,iBAAiB,CAACK,IAAI,CAAC,IAAI,CAAC;KACzD;IAEDP,KAAK,CAACI,oBAAoB,GAAG;MAC3B,MAAMC,IAAI,GAAGC,UAAU,CAAC,IAAI,CAAC;MAE7BD,IAAI,CAAC,SAASJ,UAAU,EAAE,CAAC,CAACJ,OAAO,EAAE;MACrCQ,IAAI,CAAC,SAASJ,UAAU,EAAE,CAAC,GAAG,IAAI;MAClC,OAAOG,oBAAoB,IAAIA,oBAAoB,CAACG,IAAI,CAAC,IAAI,CAAC;KAC/D;GACF;AACH"},"metadata":{},"sourceType":"module","externalDependencies":[]}